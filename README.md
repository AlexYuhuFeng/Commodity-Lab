# Commodity Lab

ä¸€ä¸ªå…¨é¢çš„å•†å“äº¤æ˜“æ•°æ®åˆ†æå¹³å°ã€‚æä¾›æ•°æ®å¯¼å…¥ã€è´¨é‡æ§åˆ¶ã€ç‰¹å¾å·¥ç¨‹ã€ç­–ç•¥å¼€å‘ã€å›æµ‹å’Œå®æ—¶ç›‘æ§åŠŸèƒ½ã€‚

**è¯­è¨€ | Language**: ä¸­æ–‡ / English (æ”¯æŒUIè¯­è¨€åˆ‡æ¢)

## âœ¨ æ ¸å¿ƒç‰¹æ€§

### ğŸ“Š **æ•°æ®ç®¡ç†** (Data Management)
- æœç´¢Yahoo Financeæ•°æ®æºï¼ˆæ”¯æŒè¿‡æ»¤å’Œåˆ†é¡µï¼‰
- è‡ªåŠ¨å¯¼å…¥å†å²ä»·æ ¼æ•°æ®
- æœ¬åœ°æ•°æ®åº“ç®¡ç†å’Œå…ƒæ•°æ®ç¼–è¾‘
- ä¸€é”®åˆ·æ–°æ‰€æœ‰å·²å…³æ³¨äº§å“
- åˆ·æ–°æ—¥å¿—è¿½è¸ª

### ğŸ” **æ•°æ®å±•ç¤º** (Data Showcase)
- ä»¿åˆ¸å•†è‚¡ç¥¨è¯¦æƒ…é¡µè®¾è®¡
- 6ä¸ªæ ‡ç­¾é¡µï¼šæ¦‚è§ˆã€ä»·æ ¼å›¾è¡¨ã€è´¨é‡æ£€æŸ¥ã€å±æ€§ã€æ´¾ç”Ÿåºåˆ—ã€æ“ä½œ
- äº¤äº’å¼ä»·æ ¼èµ°åŠ¿å›¾è¡¨
- è‡ªåŠ¨QCæ£€æŸ¥ï¼ˆç¼ºå¤±å€¼ã€å¼‚å¸¸å€¼ã€æ•°æ®é™ˆæ—§åº¦ç­‰ï¼‰
- æ´¾ç”Ÿåºåˆ—åˆ›å»ºä¸ç®¡ç†

### ğŸš¨ **ç›‘æ§ä¸å‘Šè­¦** (Monitoring & Alerts)
- 7ç§å‘Šè­¦è§„åˆ™ç±»å‹ï¼š
  - ä»·æ ¼é˜ˆå€¼å‘Šè­¦
  - Zåˆ†æ•°å¼‚å¸¸æ£€æµ‹
  - æ³¢åŠ¨ç‡çªå¢å‘Šè­¦
  - æ•°æ®è´¨é‡å‘Šè­¦ï¼ˆé™ˆæ—§ã€ç¼ºå¤±ï¼‰
  - ç›¸å…³æ€§æ–­è£‚æ£€æµ‹
  - è‡ªå®šä¹‰è¡¨è¾¾å¼å‘Šè­¦
- æ´»è·ƒå‘Šè­¦å®æ—¶æ˜¾ç¤º
- å‘Šè­¦å†å²å®Œæ•´è¿½è¸ª
- å‘Šè­¦ç¡®è®¤ä¸å¤‡æ³¨ç®¡ç†
- å†å²æ•°æ®å¯¼å‡ºï¼ˆCSVï¼‰

### ğŸ¯ **åˆ†æä¸ç­–ç•¥** (Advanced Features - å¼€å‘ä¸­)
- ç‰¹å¾å·¥ç¨‹åº“
- å…³è”æ€§åˆ†æ
- ç­–ç•¥å›æµ‹
- é£é™©æŒ‡æ ‡è®¡ç®—

### ğŸŒ **å›½é™…åŒ–** (Internationalization)
- å®Œæ•´çš„ä¸­æ–‡å’Œè‹±æ–‡æ”¯æŒ
- ä¸€é”®è¯­è¨€åˆ‡æ¢
- æ‰€æœ‰UIæ–‡æœ¬å›½é™…åŒ–

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å‰ç½®æ¡ä»¶
- Python 3.12+
- å·²åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ (`venv`)

### å®‰è£…ä¾èµ–
```bash
pip install -r requirements.txt
```

### å¯åŠ¨åº”ç”¨
```bash
# æ–¹å¼1: ä½¿ç”¨å¯åŠ¨è„šæœ¬
./run.sh

# æ–¹å¼2: ç›´æ¥ä½¿ç”¨streamlit
streamlit run app/main.py
```

åº”ç”¨å°†åœ¨ `http://localhost:8501` å¯åŠ¨

## ğŸ“– ä½¿ç”¨æŒ‡å—

### ç¬¬ä¸€æ­¥ï¼šæœç´¢å’Œå…³æ³¨äº§å“
1. æ‰“å¼€ **ğŸ“Š æ•°æ®ç®¡ç†** é¡µé¢
2. åœ¨æœç´¢æ¡†è¾“å…¥äº§å“ä»£ç  (å¦‚: `Brent`, `Natural Gas`, `EURUSD`)
3. ç‚¹å‡» **â• æ·»åŠ å…³æ³¨**
4. ç³»ç»Ÿè‡ªåŠ¨ä¸‹è½½å†å²æ•°æ®

### ç¬¬äºŒæ­¥ï¼šæŸ¥çœ‹äº§å“è¯¦æƒ…
1. æ‰“å¼€ **ğŸ” æ•°æ®å±•ç¤º** é¡µé¢
2. ä»ä¾§è¾¹æ é€‰æ‹©äº§å“
3. æµè§ˆå„ä¸ªæ ‡ç­¾é¡µï¼š
   - **æ¦‚è§ˆ**: å…³é”®æŒ‡æ ‡å’Œç»Ÿè®¡
   - **ä»·æ ¼å›¾è¡¨**: äº¤äº’å¼èµ°åŠ¿å›¾
   - **è´¨é‡æ£€æŸ¥**: è‡ªåŠ¨QCæŠ¥å‘Š
   - **å±æ€§**: äº§å“å…ƒæ•°æ®ç¼–è¾‘
   - **æ´¾ç”Ÿåºåˆ—**: åˆ›å»ºè¡ç”ŸæŒ‡æ ‡
   - **æ“ä½œ**: åˆ·æ–°ã€å¯¼å‡ºã€å…³æ³¨ç®¡ç†

### ç¬¬ä¸‰æ­¥ï¼šåˆ›å»ºå‘Šè­¦è§„åˆ™
1. æ‰“å¼€ **ğŸš¨ ç›‘æ§ä¸å‘Šè­¦** é¡µé¢
2. åœ¨"å‘Šè­¦è§„åˆ™"æ ‡ç­¾é¡µåˆ›å»ºæ–°è§„åˆ™
3. é€‰æ‹©è§„åˆ™ç±»å‹ï¼Œè®¾ç½®æ¡ä»¶
4. ç‚¹å‡»"æµ‹è¯•è§„åˆ™"éªŒè¯æ•ˆæœ
5. è§„åˆ™è‡ªåŠ¨ç”Ÿæ•ˆ

**ç¤ºä¾‹ï¼šä¸ºBrentè®¾ç½®ä»·æ ¼å‘Šè­¦ (>70)**
- è§„åˆ™åç§°: `Brent Over 70`
- ç±»å‹: `ä»·æ ¼é˜ˆå€¼`
- äº§å“: `BZ=F`
- é˜ˆå€¼: `70`
- ä¸¥é‡åº¦: `High`

## ğŸ“ é¡¹ç›®ç»“æ„

```
Commodity-Lab/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ main.py                          # ä¸»é¡µé¢ + è¯­è¨€åˆ‡æ¢
â”‚   â”œâ”€â”€ i18n.py                          # å›½é™…åŒ–æ¡†æ¶
â”‚   â””â”€â”€ pages/
â”‚       â”œâ”€â”€ 1_DataManagement.py          # ğŸ“Š æ•°æ®ç®¡ç†
â”‚       â”œâ”€â”€ 2_DataShowcase.py            # ğŸ” æ•°æ®å±•ç¤º (6ä¸ªTab)
â”‚       â”œâ”€â”€ 3_MonitoringAlerts.py        # ğŸš¨ ç›‘æ§å‘Šè­¦ (7ç§è§„åˆ™)
â”‚       â”œâ”€â”€ 4_Analytics.py               # ğŸ“ˆ åˆ†æ (å¼€å‘ä¸­)
â”‚       â””â”€â”€ 5_StrategiesBacktest.py      # ğŸ¯ ç­–ç•¥å›æµ‹ (å¼€å‘ä¸­)
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ db.py                            # æ•°æ®åº“æ“ä½œ (DuckDB)
â”‚   â”œâ”€â”€ qc.py                            # è´¨é‡æ£€æŸ¥
â”‚   â”œâ”€â”€ transforms.py                    # æ´¾ç”Ÿåºåˆ—è®¡ç®—
â”‚   â”œâ”€â”€ refresh.py                       # æ•°æ®åˆ·æ–°
â”‚   â”œâ”€â”€ yf_provider.py                   # Yahoo Financeæ¥å£
â”‚   â”œâ”€â”€ yf_prices.py                     # ä»·æ ¼è·å–
â”‚   â”œâ”€â”€ yf_search.py                     # æœç´¢åŠŸèƒ½
â”‚   â””â”€â”€ ...                              # å…¶ä»–æ¨¡å—
â”œâ”€â”€ data/
â”‚   â””â”€â”€ commodity_lab.duckdb             # æ•°æ®åº“æ–‡ä»¶
â”œâ”€â”€ run.sh                               # å¯åŠ¨è„šæœ¬
â”œâ”€â”€ requirements.txt                     # ä¾èµ–åˆ—è¡¨
â”œâ”€â”€ pyproject.toml                       # é¡¹ç›®é…ç½®
â””â”€â”€ README.md                            # æœ¬æ–‡ä»¶
```

## ğŸ—„ï¸ æ•°æ®åº“

ä½¿ç”¨ **DuckDB** ä½œä¸ºæ•°æ®åº“å¼•æ“ï¼Œå…·æœ‰ä»¥ä¸‹è¡¨ï¼š

- `instruments`: äº§å“ä¿¡æ¯ï¼ˆä»£ç ã€åç§°ã€è´§å¸ã€å•ä½ç­‰ï¼‰
- `prices_daily`: æ—¥çº¿ä»·æ ¼æ•°æ®
- `derived_daily`: æ´¾ç”Ÿåºåˆ—æ•°æ®
- `transforms`: æ´¾ç”Ÿåºåˆ—é…ç½®
- `refresh_log`: æ•°æ®åˆ·æ–°æ—¥å¿—
- `alert_rules`: å‘Šè­¦è§„åˆ™å®šä¹‰
- `alert_events`: å‘Šè­¦äº‹ä»¶å†å²

## ğŸ”§ å¼€å‘ä¿¡æ¯

### æŠ€æœ¯æ ˆ
- **å‰ç«¯**: Streamlit
- **æ•°æ®åº“**: DuckDB
- **æ•°æ®å¤„ç†**: Pandas, NumPy, Plotly
- **è‚¡ç¥¨æ•°æ®**: yfinance

### æ¨¡å—åŒ–æ¶æ„
- **core.db**: æ•°æ®åº“å±‚ï¼ˆCRUDæ“ä½œï¼‰
- **core.qc**: è´¨é‡æ§åˆ¶æ¨¡å—
- **core.transforms**: æ•°æ®è½¬æ¢æ¨¡å—
- **core.refresh**: æ•°æ®åŒæ­¥æ¨¡å—
- **app.i18n**: å›½é™…åŒ–æ¨¡å—
- **app.pages**: UIé¡µé¢

### æ‰©å±•åŠŸèƒ½

æ·»åŠ æ–°çš„å‘Šè­¦è§„åˆ™ç±»å‹ï¼š
1. åœ¨ `app/pages/3_MonitoringAlerts.py` çš„ `evaluate_alert_condition()` å‡½æ•°ä¸­æ·»åŠ æ¡ä»¶é€»è¾‘
2. åœ¨ i18n é…ç½®ä¸­æ·»åŠ æ–°è§„åˆ™çš„æ ‡ç­¾

åˆ›å»ºæ–°çš„æ´¾ç”Ÿåºåˆ—ï¼š
1. åœ¨**æ•°æ®å±•ç¤º**é¡µé¢çš„"æ´¾ç”Ÿåºåˆ—"æ ‡ç­¾é¡µä¸­å¡«å†™é…ç½®
2. ç³»ç»Ÿè‡ªåŠ¨è®¡ç®—å¹¶å­˜å‚¨ç»“æœ

## ğŸ“Š å‘Šè­¦è§„åˆ™è¯¦è§£

### ä»·æ ¼é˜ˆå€¼ (Price Threshold)
å½“æœ€æ–°ä»·æ ¼è¶…è¿‡è®¾å®šå€¼æ—¶è§¦å‘
```
æ¡ä»¶: price > threshold
ç¤ºä¾‹: BZ=F > 70
```

### Zåˆ†æ•°å¼‚å¸¸ (Z-Score)
å½“ä»·æ ¼åç¦»20æ—¥å‡å€¼è¶…è¿‡Nä¸ªæ ‡å‡†å·®æ—¶è§¦å‘
```
æ¡ä»¶: |z| > threshold
ç¤ºä¾‹: |z| > 2.5 (è¶…è¿‡2.5å€æ ‡å‡†å·®)
```

### æ³¢åŠ¨ç‡å‘Šè­¦ (Volatility)
å½“å¹´åŒ–æ³¢åŠ¨ç‡è¶…è¿‡é˜ˆå€¼æ—¶è§¦å‘
```
æ¡ä»¶: å¹´åŒ–æ³¢åŠ¨ç‡ > threshold
ç¤ºä¾‹: volatility > 0.30 (30%)
```

### æ•°æ®é™ˆæ—§å‘Šè­¦ (Data Staleness)
å½“æ•°æ®æœªæ›´æ–°è¶…è¿‡Nå¤©æ—¶è§¦å‘
```
æ¡ä»¶: days_since_update > threshold
ç¤ºä¾‹: staleness > 3 (è¶…è¿‡3å¤©)
```

### æ•°æ®ç¼ºå¤±å‘Šè­¦ (Missing Data)
å½“ç¼ºå¤±å€¼æ¯”ä¾‹è¶…è¿‡é˜ˆå€¼æ—¶è§¦å‘
```
æ¡ä»¶: missing_pct > threshold
ç¤ºä¾‹: missing > 5 (è¶…è¿‡5%)
```

## ğŸ“ˆ è·¯çº¿å›¾

### v1.1 (ä¸‹ä¸€ç‰ˆæœ¬)
- [ ] å‘Šè­¦é€šçŸ¥ç³»ç»Ÿ (Email/Telegram/Slack)
- [ ] è‡ªå®šä¹‰å‘Šè­¦æ¡ä»¶å¯è§†åŒ–ç¼–è¾‘
- [ ] Kçº¿å›¾è¡¨å’ŒæŠ€æœ¯æŒ‡æ ‡
- [ ] æ•°æ®å¯¼å‡ºæ ¼å¼å¢å¼º

### v1.2
- [ ] ç‰¹å¾å·¥ç¨‹åº“å®Œæ•´å®ç°
- [ ] å…³è”æ€§åˆ†ææ¨¡å—
- [ ] ç­–ç•¥å›æµ‹å¼•æ“
- [ ] é£é™©æŒ‡æ ‡è®¡ç®—

### v2.0
- [ ] Webéƒ¨ç½² (Docker + äº‘å¹³å°)
- [ ] å¤šç”¨æˆ·æ”¯æŒ
- [ ] æƒé™ç®¡ç†
- [ ] ç”Ÿäº§çº§ç›‘æ§

## ğŸ“ æ›´æ–°æ—¥å¿—

### v1.0 (2026-02-25) - UIé‡æ„å®Œæˆ
âœ… å®ŒæˆP0çº§åˆ«æ‰€æœ‰éœ€æ±‚
- å›½é™…åŒ–æ¡†æ¶
- æ•°æ®ç®¡ç†é¡µé¢æ•´åˆ
- æ•°æ®å±•ç¤ºé¡µé¢ï¼ˆTabè®¾è®¡ï¼‰
- å‘Šè­¦ç³»ç»Ÿï¼ˆ7ç§è§„åˆ™ç±»å‹ï¼‰
- åŠŸèƒ½æ¨¡å—åŒ–æ¶æ„

## ğŸ’¡ æœ€ä½³å®è·µ

1. **å®šæœŸåˆ·æ–°æ•°æ®**: è®¾ç½®æ¯å¤©è‡ªåŠ¨åˆ·æ–°ä»¥ä¿æŒæ•°æ®æœ€æ–°
2. **åˆ›å»ºåˆ†ç±»å‘Šè­¦**: ä¸ºä¸åŒçš„äº§å“åˆ›å»ºé’ˆå¯¹æ€§çš„å‘Šè­¦è§„åˆ™
3. **ç›‘æ§æ•°æ®è´¨é‡**: å®šæœŸæ£€æŸ¥QCæŠ¥å‘Šï¼ŒåŠæ—¶å¤„ç†é—®é¢˜
4. **ä½¿ç”¨æ´¾ç”Ÿåºåˆ—**: åˆ›å»ºæœ‰æ„ä¹‰çš„è¡ç”ŸæŒ‡æ ‡è¿›è¡Œå¯¹æ¯”åˆ†æ

## ğŸ› æ•…éšœæ’é™¤

### åº”ç”¨æ— æ³•å¯åŠ¨
```bash
# æ£€æŸ¥è™šæ‹Ÿç¯å¢ƒæ˜¯å¦æ¿€æ´»
source venv/bin/activate

# æ£€æŸ¥ä¾èµ–æ˜¯å¦å®‰è£…
pip install -r requirements.txt

# æ£€æŸ¥ç«¯å£8501æ˜¯å¦è¢«å ç”¨
lsof -i :8501
```

### æ•°æ®å¯¼å…¥å¤±è´¥
- æ£€æŸ¥ç½‘ç»œè¿æ¥
- ç¡®è®¤äº§å“ä»£ç æ­£ç¡® (ä½¿ç”¨æœç´¢åŠŸèƒ½éªŒè¯)
- æŸ¥çœ‹åˆ·æ–°æ—¥å¿—äº†è§£é”™è¯¯è¯¦æƒ…

### å‘Šè­¦è§„åˆ™æœªè§¦å‘
- åœ¨å‘Šè­¦è§„åˆ™ç®¡ç†ä¸­ç‚¹å‡»"æµ‹è¯•è§„åˆ™"éªŒè¯
- ç¡®è®¤è§„åˆ™å·²å¯ç”¨
- æ£€æŸ¥äº§å“æ•°æ®æ˜¯å¦å­˜åœ¨

## ğŸ“ æ”¯æŒ

æœ‰ä»»ä½•é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·ï¼š
1. æŸ¥çœ‹ [UI_REDESIGN_GUIDE.md](UI_REDESIGN_GUIDE.md) è·å–è¯¦ç»†æ–‡æ¡£
2. æ£€æŸ¥åº”ç”¨å†…çš„å¸®åŠ©ä¿¡æ¯
3. æäº¤Issueæˆ–è”ç³»å¼€å‘å›¢é˜Ÿ

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ‘¨â€ğŸ’» ä½œè€…

Commodity Lab Development Team


## Requirements

- Python 3.12+
- See `pyproject.toml` for detailed dependencies

## Installation

1. **Clone the repository**:
```bash
git clone <repository-url>
cd Commodity-Lab
```

2. **Create a virtual environment** (recommended):
```bash
python -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate
```

3. **Install dependencies**:

**Option A (Common and Simple):**
```bash
pip install -r requirements.txt
```

**Option B (Development mode with editable install):**
```bash
pip install -e .
```

We recommend **Option A** for most users. Option B is useful if you're developing the `core` module and want changes reflected immediately without reinstalling.

## Usage

Run the Streamlit application:

```bash
streamlit run app/main.py
```

This will start a local web server (typically at `http://localhost:8501`) where you can access the application.

## Workflow

1. **Start with Data**: Go to the Data page to ingest commodity price data
2. **Quality Control**: Use the QC page to validate data integrity
3. **Transforms**: Apply unit and FX standardization as needed
4. **Features**: Engineer features for analysis
5. **Strategies**: Develop trading strategies
6. **Backtest**: Test strategy performance on historical data
7. **Monitor**: Set up real-time monitoring and alerts

## Technologies

- **Streamlit**: Web application framework
- **Pandas**: Data manipulation and analysis
- **DuckDB**: Lightweight SQL database for data storage
- **yfinance**: Financial data fetching
- **Plotly**: Interactive visualizations

## Development

To work with the project:

```bash
# Create and activate virtual environment
python -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate

# Install dependencies
pip install -r requirements.txt

# Or for editable development mode
pip install -e .

# Run the app
streamlit run app/main.py

# Run specific pages for testing
streamlit run app/pages/0_Catalog.py
```

## Database

The project uses DuckDB for data storage. The database file is located at `data/commodity_lab.duckdb`.

## License

[Add your license information here]

## Contributing

[Add contribution guidelines here]